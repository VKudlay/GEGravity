<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GE_Gravity Theory • GEGravity</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GE_Gravity Theory">
<meta property="og:description" content="GEGravity">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GEGravity</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about.html">GE_Gravity Theory, Logic, Testing, and Comparison</a>
    </li>
    <li>
      <a href="../articles/compare.html">GE_Gravity Logic and Testing</a>
    </li>
    <li>
      <a href="../articles/example.html">GE_Gravity Example</a>
    </li>
    <li>
      <a href="../articles/logic.html">GE_Gravity Logic</a>
    </li>
    <li>
      <a href="../articles/theory.html">GE_Gravity Theory</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VKudlay/GEGravity/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GE_Gravity Theory</h1>
                        <h4 data-toc-skip class="author">Tom Zylkin,
Vadim Kudlay</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/VKudlay/GEGravity/blob/HEAD/vignettes/theory.Rmd" class="external-link"><code>vignettes/theory.Rmd</code></a></small>
      <div class="hidden name"><code>theory.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>As a typical application, consider the following model for
international trade flows: <span class="math display">\[X_{ij}
=\frac{A_{i}w_{i}^{-\theta}\tau_{ij}^{-\theta}}{\sum_{k}A_{k}w_{k}^{-\theta}\tau_{kj}^{-\theta}}E_{j}\]</span></p>
<p><span class="math inline">\(X_{ij}\)</span> are international trade
flows. <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are indices for origin and destination.
<span class="math inline">\(E_{j} \equiv \sum_{i}X_{ij}\)</span> is
total expenditure (also equal to the sum of the value of shipments
across all origins). <span class="math inline">\(A_{i}\)</span> is a
measure of the level of technology in each origin <span class="math inline">\(i\)</span>, <span class="math inline">\(w_{i}\)</span> is the production cost, and <span class="math inline">\(\tau_{ij} &gt; 1\)</span> is an iceberg trade
cost. The model assumes that goods received from different origins are
imperfectly substitutable and that the degree of substitutability is
governed by <span class="math inline">\(\theta &gt; 0\)</span>, which
serves as a trade elasticity. Labor, <span class="math inline">\(L_{i}\)</span>, is assumed to be the only factor
of production. Trade imbalances, treated as exogenously given, are
accounted for as an additive component of expenditure. Thus, we can also
write national expenditure as the sum of labor income and the national
trade deficit/surplus: <span class="math inline">\(E_{j} = w_{j}L_{j} +
D_{j}\)</span>.</p>
<p>To obtain the effects of changes in trade policies on trade (i.e.,
holding all wages fixed), a standard approach is to estimate using
structural gravity. For example, if we have a panel of trading countries
and we want to know the “average partial effect” of FTAs on trade, we
can estimate the following “three-way” gravity regression:</p>
<p><span class="math display">\[X_{ijt}
=\exp\left[\ln\alpha_{it}+\ln\alpha_{jt}+\ln\alpha_{ij}+\beta\times
FTA_{ijt}\right]+e_{ijt},\]</span></p>
<p>As discussed in Yotov, Piermartini, Monteiro, &amp; Larch (2016), the
estimated <span class="math inline">\(\beta\)</span> from this
specification tells us how much trade would increase on average between
any pair of countries that sign an FTA if we hold fixed all the
endogenous variables in the model. Or, put in more structural terms, it
tells us the direct trade impact of the reduction in trade barriers
associated with an FTA: <span class="math inline">\(\beta=-\theta\Delta\ln\tau_{ijt}\)</span>.</p>
<p>However, often the real goal is to compute changes in real wages,
welfare, and/or trade volumes as a result of a change in trade
frictions. In general equilibrium, the value of a country’s shipments
across all destinations must add up to its labor income (<span class="math inline">\(Y_{i} \equiv w_{i}L_{i} =
\sum_{j}X_{ij}.\)</span>) In other words, we must have that</p>
<p><span class="math display">\[w_{i}L_{i} =\sum_{j}
\frac{A_{i}w_{i}^{-\theta}\tau_{ij}^{-\theta}}
     {\sum_{k}A_{k}w_{k}^{-\theta}\tau_{kj}^{-\theta}}
\left(w_{j}L_{j}+D_{j}\right) \quad \forall i.\]</span></p>
<p>This equation pins down each country’s wages (subject to a
normalization) as a function of how easily it can sell to markets with
high levels of demand. Similarly, notice that we can express the
effective price level in each country, <span class="math inline">\(P_{j}
\equiv
\left[\sum_{k}A_{k}w_{k}^{-\theta}\tau_{kj}^{-\theta}\right]^{-1/\theta}\)</span>,
as a function of how easily a country can buy from producers with high
technology levels and low production costs. These linkages are both
intuitive and general; they can be found in many different trade models
typically used for GE analysis.</p>
<p>A useful point about the system of equations in wages is that it can
be solved in “changes” (as opposed to solving it in levels). Adopting
the notation of Dekle, Eaton, &amp; Kortum (2007), let a “hat” over a
variable denote the change in that variable resulting from a policy
change (e.g., <span class="math inline">\(\widehat{w}_{i}\equiv
w_{i}^{\prime}/w_{i}\)</span> gives the change in <span class="math inline">\(i\)</span>’s wage level.) Noting that <span class="math inline">\(\widehat{\tau}_{ij}^{-\theta}=e^{\beta\times
FTA_{ij}}\)</span>, the “equilibrium in changes” version of wages can be
written as:</p>
<p><span class="math display">\[Y_{i}\widehat{w}_{i} =
\widehat{w}_{i}^{-\theta}
\sum_{j}\frac{\pi_{ij}\cdot e^{\beta \times FTA_{ij}}}
             {\widehat{P}_{j}^{-\theta}}
\cdot\left(Y_{j}\widehat{w}_{j} + D_{j}\right) \quad\forall
i,\]</span></p>
<p>where <span class="math inline">\(\pi_{ij}\equiv
X_{ij}/E_{j}\)</span> is a bilateral trade share and <span class="math inline">\(\widehat{P}_{j}\equiv\left[\sum_{k}\pi_{kj}\widehat{w}_{k}^{-\theta}e^{\beta\times
FTA_{kj}}\right]^{-1/\theta}\)</span> describes the change in price
levels in each country. Notice this equation can be solved without
knowledge of technology levels, endowments, initial trade frictions, or
initial wages. All that is needed are trade volumes, national output and
expenditure levels, and a value for the trade elasticity <span class="math inline">\(\theta\)</span>.</p>
<p>Once changes in wages are known, GE changes in welfare, real wages,
and trade volumes are given respectively by: <span class="math display">\[
\begin{alignat}{1}
\textbf{GE Welfare Impact}:\quad &amp;
\widehat{W}_{i}=\widehat{E}_{i}/\widehat{P}_{i}\\ \\
\textbf{GE Real Wage Impact}:\quad &amp;
\widehat{rw}_{ij}=\widehat{w}_{i}/\widehat{P}_{i},\\
\textbf{GE Trade Impact}:\quad &amp;
\widehat{X}_{ij}=\frac{\widehat{w}_{i}^{-\theta}e^{\beta\times
FTA_{ij}}}{\widehat{P}_{j}^{-\theta}}\cdot\widehat{E}_{j}
\end{alignat}
\]</span> where the change in national expenditure, <span class="math inline">\(\widehat{E}_{i}\)</span>, is given by <span class="math inline">\((Y_{i}\widehat{w}_{i} + D_{i}) / E_{i}\)</span>.
Because trade volumes are nominal quantities, there is one normalization
needed. For this, the algorithm assumes that total world output is the
same across both the baseline and the counterfactual (i.e., <span class="math inline">\(\sum_{i}Y_{i}\widehat{w}_{i} =
\sum_{i}Y_{i}\)</span>.) The precise method used to solve the model is
described further below.</p>
</div>
<div class="section level2">
<h2 id="algorithm">Algorithm<a class="anchor" aria-label="anchor" href="#algorithm"></a>
</h2>
<p>While there are several ways to solve for counterfactuals in the
above model, the simplest approach is arguably a fixed point algorithm
that repeatedly iterates on the equilibrium conditions of the model.
There are numerous ways to implement such an algorithm, but the approach
used in Baier, Yotov, &amp; Zylkin (2019) is especially simple to
program. We first initialize <span class="math inline">\(\widehat{w}_{i}=\widehat{P}_{i}^{-\theta}=1\)</span>
<span class="math inline">\(\forall i\)</span> and <span class="math inline">\(E_{i}^{\prime}=E_{i}\)</span><span class="math inline">\(\forall i\)</span>. The iteration loop then
requires only 4 steps:</p>
<ol style="list-style-type: decimal">
<li><p>Update <span class="math inline">\(\widehat{w}_{i}\)</span> <span class="math inline">\(\forall\)</span> <span class="math inline">\(i\)</span> one time using <span class="math display">\[\widehat{w}_{i} =
\left[Y_{i}^{-1}\sum_{j}\frac{\pi_{ij}\cdot e^{\beta\times
FTA_{ij}}}{\widehat{P}_{j}^{-\theta}}\cdot
E_{j}^{\prime}\right]^{\frac{1}{1+\theta}}\quad\forall
i.\]</span></p></li>
<li><p>Normalize all wages so that world output stays fixed: <span class="math inline">\(\sum_{i}Y_{i}\widehat{w}_{i}=\sum_{i}Y_{i}\)</span>.</p></li>
<li><p>Update <span class="math inline">\(\widehat{P}_{j}^{-\theta}=\left[\sum_{k}\pi_{kj}\widehat{w}_{k}^{-\theta}e^{b\times
FTA_{kj}}\right]\)</span> <span class="math inline">\(\forall\)</span>
<span class="math inline">\(j\)</span>.</p></li>
<li><p>Update <span class="math inline">\(E_{j}^{\prime}=Y_{j}\widehat{w}_{j}+D_{j}\)</span>
<span class="math inline">\(\forall\)</span> <span class="math inline">\(j\)</span>.</p></li>
</ol>
<ul>
<li>(Repeat steps 1-4 until convergence.)</li>
</ul>
<p>This algorithm is very similar to one previously made available by
Head &amp; Mayer (2014), but takes a slightly more streamlined approach
to updating wages in step 1. It should generally be very fast because it
does not involve using a nonlinear solver.</p>
</div>
<div class="section level2">
<h2 id="advisory">Advisory<a class="anchor" aria-label="anchor" href="#advisory"></a>
</h2>
<p>This is an advanced technique that requires a basic understanding of
the model being solved. I would recommend reading either Section 4.3 of
Head &amp; Mayer (2014) or Ch. 2 of Yotov, Piermartini, Monteiro, &amp;
Larch (2016) before implementing.</p>
<p>One common issue that researchers new to these methods should be
aware of is that GE trade models require a “square” data set with
information on internal trade flows in addition to data on international
trade flows. In the model, these internal flows are denoted by <span class="math inline">\(X_{ii}\)</span>. If <code>ge_gravity</code>
detects that the variable given for does not include one or more <span class="math inline">\(X_{ii}\)</span> terms, it will exit with an error.
Not all publicly available trade data sets include internal trade
values. But some that do include <a href="http://www.wiod.org/home" class="external-link">WIOD</a>, <a href="https://worldmrio.com/" class="external-link">Eora MRIO</a>, and the data set made
available by <a href="https://vi.unctad.org/tpa/index.html" class="external-link">UNCTAD</a>
as part of their online course on trade policy analysis (see Yotov,
Piermartini, Monteiro, &amp; Larch, 2016.)</p>
<p>Depending on interest, future versions could feature additional
options such as allowances for tariff revenues and/or multiple sectors.
If you believe you have found an error that can be replicated, or have
other suggestions for improvements, please feel free to<br><a href="mailto:tomzylkin@gmail.com">contact me</a>.</p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>The basic idea of using fixed point iteration to solve the gravity
model has previously been implemented in Stata by Head &amp; Mayer
(2014) and Anderson, Larch, &amp; Yotov (2015).</p>
</div>
<div class="section level2">
<h2 id="suggested-citation">Suggested citation<a class="anchor" aria-label="anchor" href="#suggested-citation"></a>
</h2>
<p>If you are using this command in your research, I would appreciate if
you would cite</p>
<ul>
<li>Baier, Scott L., Yoto V. Yotov, and Thomas Zylkin. “On the widely
differing effects of free trade agreements: Lessons from twenty years of
trade integration”. Journal of International Economics 116 (2019):
206-226.</li>
</ul>
<p>The algorithm used in this command was specifically written for the
exercises performed in this paper. Section 6 of the paper provides a
more detailed description of the underlying model and its connection to
the literature.</p>
</div>
<div class="section level2">
<h2 id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<ul>
<li>Structural gravity: Anderson &amp; van Wincoop (2003); Head &amp;
Mayer (2014)</li>
<li>Methods for solving trade models: Alvarez &amp; Lucas (2007);
Anderson, Larch, &amp; Yotov (2015); Head &amp; Mayer (2014)</li>
<li>Hat algebra: Dekle, Eaton, &amp; Kortum (2007)</li>
<li>GE effects of EU enlargements: Felbermayr, Gröschl, &amp; Heiland
(2018); Mayer, Vicard, &amp; Zignago (2018).</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0304393206002169" class="external-link">Alvarez,
F. &amp; Lucas, J., Robert E. (2007), “General equilibrium analysis of
the Eaton–Kortum model of international trade”, Journal of Monetary
Economics 54(6), 1726–1768.</a></p>
<p><a href="https://ideas.repec.org/p/ces/ceswps/_5592.html" class="external-link">Anderson,
J. E., Larch, M., &amp; Yotov, Y. V. (2015), “Estimating General
Equilibrium Trade Policy Effects: GE PPML”, CESifo Working Paper
5592.</a></p>
<p><a href="https://www.jstor.org/stable/3132167?seq=1" class="external-link">Anderson, J. E.
&amp; van Wincoop, E. (2003), “Gravity with Gravitas: A Solution to the
Border Puzzle”, American Economic Review 93(1), 170–192.</a></p>
<p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0022199615001531" class="external-link">Anderson,
J. E. &amp; Yotov, Y. V. (2016), “Terms of trade and global efficiency
effects of free trade agreements, 1990–2002”, Journal of International
Economics 99, 279–298.</a></p>
<p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0022199618304367" class="external-link">Baier,
S. L., Yotov, Y. V., &amp; Zylkin, T. (2019), “On the widely differing
effects of free trade agreements: Lessons from twenty years of trade
integration”, Journal of International Economics 116, 206–226.</a></p>
<p><a href="https://ideas.repec.org/p/arx/papers/1903.01690.html" class="external-link">Correia, S.,
Guimarães, P., &amp; Zylkin, T. (2019), “ppmlhdfe: Fast Poisson
Estimation with High-Dimensional Data”, arXiv preprint
arXiv:1903.01690.</a></p>
<p><a href="https://www.researchgate.net/publication/4981229_Unbalanced_Trade" class="external-link">Dekle,
R., Eaton, J., &amp; Kortum, S. (2007), “Unbalanced Trade”, American
Economic Review 97(2), 351–355. Egger, P., Larch, M., Staub, K. E.,
&amp; Winkelmann, R. (2011), “The Trade Effects of Endogenous
Preferential</a></p>
<p><a href="https://www.jstor.org/stable/41238105?seq=1" class="external-link">Trade
Agreements”, American Economic Journal: Economic Policy 3(3),
113–143.</a></p>
<p><a href="https://ideas.repec.org/p/ces/ifowps/_250.html" class="external-link">Felbermayr,
G., Gröschl, J. K., &amp; Heiland, I. (2018), “Undoing Europe in a new
quantitative trade model”, Tech. rep., Ifo Working Paper.</a></p>
<p><a href="http://www.cepii.fr/pdf_pub/wp/2013/wp2013-27.pdf" class="external-link">Head, K.
&amp; Mayer, T. (2014), “Gravity Equations: Workhorse, Toolkit, and
Cookbook”, in G. Gopinath, E. Help- man, &amp; K. Rogoff (eds.) Handbook
of International Economics, vol. 4, pp. 131–195, North Holland, 4
ed.</a></p>
<p><a href="http://www.cepii.fr/PDF_PUB/wp/2018/wp2018-06.pdf" class="external-link">Mayer,
T., Vicard, V., &amp; Zignago, S. (2018), “The cost of non-Europe,
revisited”.</a></p>
<p><a href="https://www.wto.org/english/res_e/booksp_e/advancedwtounctad2016_e.pdf" class="external-link">Yotov,
Y. V., Piermartini, R., Monteiro, J.-A., &amp; Larch, M. (2016), An
Advanced Guide to Trade Policy Analysis: The Structural Gravity Model,
World Trade Organization, Geneva.</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tom Zylkin, Vadim Kudlay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
