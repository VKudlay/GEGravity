<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Solves a general equilibrium one sector Armington-CES trade model. — ge_gravity • GEGravity</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Solves a general equilibrium one sector Armington-CES trade model. — ge_gravity"><meta property="og:description" content="ge_gravity solves for general equilibrium effects of changes in trade policies
  using a one sector Armington-CES trade model. It uses a simple fixed point
  algorithm that allows for fast computation that makes this program
  ideal for bootstrapping confidence intervals for general equilibrium simulations
  based on prior gravity estimates of FTAs or other similar variables.
Examples of references that conduct general equilibrium analysis based on FTA
  estimates in this way include Egger, Larch, Staub, &amp;amp; Winkelmann (2011),
  Anderson &amp;amp; Yotov (2016), and Baier, Yotov, &amp;amp; Zylkin (2019). Yotov, Piermartini,
  Monteiro, &amp;amp; Larch (2016) provide a detailed survey and introduction to the topic."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GEGravity</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/about.html">GE_Gravity Theory, Logic, Testing, and Comparison</a>
    </li>
    <li>
      <a href="../articles/compare.html">GE_Gravity Logic and Testing</a>
    </li>
    <li>
      <a href="../articles/example.html">GE_Gravity Example</a>
    </li>
    <li>
      <a href="../articles/logic.html">GE_Gravity Logic</a>
    </li>
    <li>
      <a href="../articles/theory.html">GE_Gravity Theory</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/VKudlay/GEGravity/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Solves a general equilibrium one sector Armington-CES trade model.</h1>
    <small class="dont-index">Source: <a href="https://github.com/VKudlay/GEGravity/blob/HEAD/R/ge_gravity.R" class="external-link"><code>R/ge_gravity.R</code></a></small>
    <div class="hidden name"><code>ge_gravity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>ge_gravity</code> solves for general equilibrium effects of changes in trade policies
  using a one sector Armington-CES trade model. It uses a simple fixed point
  algorithm that allows for fast computation that makes this program
  ideal for bootstrapping confidence intervals for general equilibrium simulations
  based on prior gravity estimates of FTAs or other similar variables.</p>
<p>Examples of references that conduct general equilibrium analysis based on FTA
  estimates in this way include Egger, Larch, Staub, &amp; Winkelmann (2011),
  Anderson &amp; Yotov (2016), and Baier, Yotov, &amp; Zylkin (2019). Yotov, Piermartini,
  Monteiro, &amp; Larch (2016) provide a detailed survey and introduction to the topic.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ge_gravity</span><span class="op">(</span><span class="va">exp_id</span>, <span class="va">imp_id</span>, <span class="va">flows</span>, <span class="va">beta</span>, theta <span class="op">=</span> <span class="fl">1</span>, mult <span class="op">=</span> <span class="cn">FALSE</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>exp_id</dt>
<dd><p>String representation of the exporter/origin country associated with each observation.
This is arbitrary and for organization purposes only, i.e. AUS, Australia</p></dd>


<dt>imp_id</dt>
<dd><p>String representation of the importer/destination country associated with each observation.
This is arbitrary and for organization purposes only, i.e. AUS, Australia</p></dd>


<dt>flows</dt>
<dd><p>Observed trade flows in the data for the year being used as the baseline for the counterfactual.</p></dd>


<dt>beta</dt>
<dd><p>An input reflecting the "partial" change in trade, typically obtained as a coefficient from a
prior gravity estimation.</p></dd>


<dt>theta</dt>
<dd><p>Overall trade elasticity</p></dd>


<dt>mult</dt>
<dd><p>If true, assume that national expenditure is a fixed multiple of national output,
as in Anderson &amp; Yotov (2016).
Otherwise (and by default), handle unbalances in the data by treating the
trade balance as an additive component of national expenditure (see below).</p></dd>


<dt>data</dt>
<dd><p>A list to which we should add the new values. By default, this is an empty list.
Note that this will be converted to a named dataframe on output.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A dataframe element containing resulting estimations of impacts.
   Specifically, it returns results for general equilibrium changes in trade flows,
   welfare, and real wages as a result of the change in trade frictions.
   If `data` is specified, the results will be added as columns.</p>


<p>This data will include the following:</p>
<p></p>
<ul><li><p><code>new_trade</code>:   The new level of trade for each pair of countries.</p></li>
<li><p><code>welfare</code>:     The exporter's change in welfare (new/old level of welfare)</p></li>
<li><p><code>real_wage</code>:   The exporter's change in real wage (new/old real wage). <br>
       Note: this is generally different from the change in welfare
       unless either trade is balanced or the "multiplicative" option is chosen.</p></li>
<li><p><code>nom_wage</code>:    The exporter's change in nominal wage (new/old nom wage).</p></li>
<li><p><code>price_index</code>: The exporter's change in price index (new/old price index)</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Please see <code>browseVignettes("GEGravity")</code> for additional details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Please see <code>browseVignettes("GEGravity")</code> for information on references and sources.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The vignettes allow you to access very explanatory RMD files to augment documentation.
     Please check them out!</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># For a detailed explanation, check out the vignettes (see \code{browseVignettes("GEGravity")})</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Foreign trade subset</span></span></span>
<span class="r-in"><span><span class="va">f_trade</span> <span class="op">&lt;-</span> <span class="va">TradeData0014</span><span class="op">[</span><span class="va">TradeData0014</span><span class="op">$</span><span class="va">exporter</span> <span class="op">!=</span> <span class="va">TradeData0014</span><span class="op">$</span><span class="va">importer</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize trade data to unit interval</span></span></span>
<span class="r-in"><span><span class="va">f_trade</span><span class="op">$</span><span class="va">trade</span> <span class="op">&lt;-</span> <span class="va">f_trade</span><span class="op">$</span><span class="va">trade</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f_trade</span><span class="op">$</span><span class="va">trade</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># classify FEs for components to be absorbed (finding variable interactions)</span></span></span>
<span class="r-in"><span><span class="va">f_trade</span><span class="op">$</span><span class="va">exp_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">f_trade</span><span class="op">$</span><span class="va">expcode</span>, <span class="va">f_trade</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f_trade</span><span class="op">$</span><span class="va">imp_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">f_trade</span><span class="op">$</span><span class="va">impcode</span>, <span class="va">f_trade</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f_trade</span><span class="op">$</span><span class="va">pair</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">f_trade</span><span class="op">$</span><span class="va">impcode</span>, <span class="va">f_trade</span><span class="op">$</span><span class="va">expcode</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit generalized linear model based on specifications</span></span></span>
<span class="r-in"><span><span class="va">partials</span> <span class="op">&lt;-</span> <span class="fu">alpaca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/alpaca/man/feglm.html" class="external-link">feglm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">trade</span> <span class="op">~</span> <span class="va">eu_enlargement</span> <span class="op">+</span> <span class="va">other_fta</span> <span class="op">|</span> <span class="va">exp_year</span> <span class="op">+</span> <span class="va">imp_year</span> <span class="op">+</span> <span class="va">pair</span>,</span></span>
<span class="r-in"><span>  data    <span class="op">=</span> <span class="va">f_trade</span>,</span></span>
<span class="r-in"><span>  family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">$</span><span class="va">coefficient</span>  <span class="co"># We just need the coefficients for computation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sort trade matrix to make it easier to find imp/exp pairs</span></span></span>
<span class="r-in"><span><span class="va">t_trade</span> <span class="op">&lt;-</span> <span class="va">TradeData0014</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">TradeData0014</span><span class="op">$</span><span class="va">exporter</span>,</span></span>
<span class="r-in"><span>  <span class="va">TradeData0014</span><span class="op">$</span><span class="va">importer</span>,</span></span>
<span class="r-in"><span>  <span class="va">TradeData0014</span><span class="op">$</span><span class="va">year</span></span></span>
<span class="r-in"><span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">t_trade</span><span class="op">$</span><span class="va">eu_effect</span> <span class="op">&lt;-</span> <span class="cn">NA</span>      <span class="co"># Column for the partial effect of EU membership for new EU pairs</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="co"># Effect of EU entrance on country based on partial, if entry happened</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span><span class="va">t_trade</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">t_trade</span><span class="op">$</span><span class="va">expcode</span>, <span class="va">t_trade</span><span class="op">$</span><span class="va">impcode</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Was a new EU pair created within time span?</span></span></span>
<span class="r-in"><span>  <span class="va">t_trade</span><span class="op">[</span><span class="va">i</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"eu_effect"</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">row</span><span class="op">$</span><span class="va">eu_enlargement</span>, lag<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">i</span> <span class="op">&lt;&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># If added to EU, give it the computed partial eu_enlargement coefficient as the effect</span></span></span>
<span class="r-in"><span><span class="va">t_trade</span><span class="op">$</span><span class="va">eu_effect</span> <span class="op">=</span> <span class="va">t_trade</span><span class="op">$</span><span class="va">eu_effect</span> <span class="op">*</span> <span class="va">partials</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data to be finally fed to the function</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">t_trade</span><span class="op">[</span><span class="va">t_trade</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2000</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Running Actual Computations</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Difference between w_mult and w_o_mult is how trade balance is considered</span></span></span>
<span class="r-in"><span><span class="co">## mult = TRUE assumes multiplicative trade balances; false assumes additive</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w_mult</span> <span class="op">&lt;-</span> <span class="fu">ge_gravity</span><span class="op">(</span></span></span>
<span class="r-in"><span>  exp_id <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">expcode</span>,     <span class="co"># Origin country associated with each observation</span></span></span>
<span class="r-in"><span>  imp_id <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">impcode</span>,     <span class="co"># Destination country associated with each observation</span></span></span>
<span class="r-in"><span>  flows  <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">trade</span>,       <span class="co"># Observed trade flows for the baseline year</span></span></span>
<span class="r-in"><span>  beta   <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">eu_effect</span>,   <span class="co"># "Partial" trade change; coefficient from gravity estimation</span></span></span>
<span class="r-in"><span>  theta  <span class="op">=</span> <span class="fl">4</span>,                <span class="co"># Trade elasticity</span></span></span>
<span class="r-in"><span>  mult   <span class="op">=</span> <span class="cn">TRUE</span>,             <span class="co"># Assume national expenditure is fixed multiple of nat. output</span></span></span>
<span class="r-in"><span>  data   <span class="op">=</span> <span class="va">data</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w_o_mult</span> <span class="op">&lt;-</span> <span class="fu">ge_gravity</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">expcode</span>,              <span class="co"># Origin country associated with each observation</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">impcode</span>,              <span class="co"># Destination country associated with each observation</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">trade</span>,                <span class="co"># Observed trade flows for the baseline year</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">eu_effect</span>,            <span class="co"># "Partial" change in trade; coefficient from gravity estimation</span></span></span>
<span class="r-in"><span>  <span class="fl">4</span>,                         <span class="co"># Trade elasticity</span></span></span>
<span class="r-in"><span>  <span class="cn">FALSE</span>,                     <span class="co"># Assume trade balance is additive component of nat. expenditure</span></span></span>
<span class="r-in"><span>  <span class="va">data</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tom Zylkin, Vadim Kudlay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

